---

title: Geo

keywords: fastai
sidebar: home_sidebar

summary: "This module provides classes and functions to facilitate working with geographical data."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_geo.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Region" class="doc_header"><code>class</code> <code>Region</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L26" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Region</code>(<strong><code>name</code></strong>:<code>str</code>, <strong><code>bbox</code></strong>:<code>list</code>, <strong><code>pixel_size</code></strong>:<code>float</code>)</p>
</blockquote>
<p>Defines a geographical region with a name, a bounding box and the pixel size</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Region.width" class="doc_header"><code>Region.width</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Width of the region</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Region.height" class="doc_header"><code>Region.height</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Height of the region</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Region.transform" class="doc_header"><code>Region.transform</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Rasterio Affine transform of the region</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Region.shape" class="doc_header"><code>Region.shape</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Shape of the region (height, width)</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Region.coords" class="doc_header"><code>Region.coords</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L53" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Region.coords</code>(<strong><code>offset</code></strong>=<em><code>'ul'</code></em>)</p>
</blockquote>
<p>Computes longitude and latitude arrays given a shape and a rasterio Affine transform</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Region.load" class="doc_header"><code>Region.load</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L60" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Region.load</code>(<strong><code>file</code></strong>)</p>
</blockquote>
<p>Loads region information from json file</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Region.export" class="doc_header"><code>Region.export</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Region.export</code>(<strong><code>file</code></strong>)</p>
</blockquote>
<p>Exports region information to json file</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Examples:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">Region</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span> <span class="n">pixel_size</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>name: PI
bbox: BoundingBox(left=-10, bottom=36, right=5, top=44)
pixel_size: 0.01</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(800, 1500)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">1500</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">transform</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Affine(0.01, 0.0, -10.0,
       0.0, -0.01, 44.0)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Affine</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">44.0</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">coords</span><span class="p">()</span>
<span class="n">lon</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([-10.  ,  -9.99,  -9.98, ...,   4.97,   4.98,   4.99])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Geo-functions">Geo functions<a class="anchor-link" href="#Geo-functions">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="open_shp" class="doc_header"><code>open_shp</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L75" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>open_shp</code>(<strong><code>file</code></strong>)</p>
</blockquote>
<p>Read shapefile</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="open_tif" class="doc_header"><code>open_tif</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L79" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>open_tif</code>(<strong><code>file</code></strong>)</p>
</blockquote>
<p>Read tiff</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bounds_from_shapefile" class="doc_header"><code>bounds_from_shapefile</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L83" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bounds_from_shapefile</code>(<strong><code>shapefile</code></strong>)</p>
</blockquote>
<p>Computes bounding box for shapefile</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="size_from_bounds" class="doc_header"><code>size_from_bounds</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L88" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>size_from_bounds</code>(<strong><code>bounds</code></strong>, <strong><code>resolution</code></strong>)</p>
</blockquote>
<p>Computes width and height from bounds for a given pixel resolution</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="size_resolution_assert" class="doc_header"><code>size_resolution_assert</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L95" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>size_resolution_assert</code>(<strong><code>size</code></strong>, <strong><code>resolution</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="rasterize" class="doc_header"><code>rasterize</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L101" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>rasterize</code>(<strong><code>x</code></strong>, <strong><code>value_key</code></strong>=<em><code>None</code></em>, <strong><code>region</code></strong>=<em><code>None</code></em>, <strong><code>merge_alg</code></strong>=<em><code>'replace'</code></em>)</p>
</blockquote>
<p>Rasterize shapefile</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="downsample" class="doc_header"><code>downsample</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L112" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>downsample</code>(<strong><code>x</code></strong>, <strong><code>src_tfm</code></strong>=<em><code>None</code></em>, <strong><code>dst_tfm</code></strong>=<em><code>None</code></em>, <strong><code>dst_shape</code></strong>=<em><code>None</code></em>, <strong><code>src_crs</code></strong>=<em><code>{'init': 'EPSG:4326'}</code></em>, <strong><code>dst_crs</code></strong>=<em><code>{'init': 'EPSG:4326'}</code></em>, <strong><code>resampling</code></strong>=<em><code>'average'</code></em>)</p>
</blockquote>
<p>Donwsample a numpy array x</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="is_intersection" class="doc_header"><code>is_intersection</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L127" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>is_intersection</code>(<strong><code>gdf1</code></strong>, <strong><code>gdf2</code></strong>)</p>
</blockquote>
<p>Find the intersection between two geo pandas dataframes</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="polygon_from_bounds" class="doc_header"><code>polygon_from_bounds</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L131" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>polygon_from_bounds</code>(<strong><code>bounds</code></strong>, <strong><code>to_GeoDataFrame</code></strong>=<em><code>False</code></em>, <strong><code>crs</code></strong>=<em><code>{'init': 'EPSG:4326'}</code></em>)</p>
</blockquote>
<p>Create a polygon object from bounds</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="crop" class="doc_header"><code>crop</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>crop</code>(<strong><code>x</code></strong>, <strong><code>bounds</code></strong>=<em><code>None</code></em>, <strong><code>shape</code></strong>=<em><code>None</code></em>, <strong><code>crop</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Crop rasterio dataset for a region defined by bounds.
    x is a dataset or a list of datasets (rasterio.open).
    If list then merge with bounds is used.
    else mask is used to crop given bounds or any given shape.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bounds_from_coords" class="doc_header"><code>bounds_from_coords</code><a href="https://github.com/mnpinto/banet/tree/master/banet/geo.py#L154" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bounds_from_coords</code>(<strong><code>lon</code></strong>, <strong><code>lat</code></strong>)</p>
</blockquote>
<p>Compute bounds list form lon lat coords</p>

</div>

</div>

</div>
</div>

</div>
</div>
 

