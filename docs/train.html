---

title: Train

keywords: fastai
sidebar: home_sidebar

summary: "This module include classes and functions to train BA-Net"
description: "This module include classes and functions to train BA-Net"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05_train.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Callbacks">Callbacks<a class="anchor-link" href="#Callbacks"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SampleEpisode" class="doc_header"><code>class</code> <code>SampleEpisode</code><a href="https://github.com/mnpinto/banet/tree/master/banet/train.py#L17" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SampleEpisode</code>(<strong><code>data_source</code></strong>, <strong><code>n_episodes</code></strong>, <strong><code>sequence_len</code></strong>, <strong><code>n_sequences</code></strong>, <strong><code>info_df</code></strong>, <strong><code>nburned</code></strong>=<em><code>100</code></em>) :: <code>Sampler</code></p>
</blockquote>
<p>Base class for all Samplers.</p>
<p>Every Sampler subclass has to provide an :meth:<code>__iter__</code> method, providing a
way to iterate over indices of dataset elements, and a :meth:<code>__len__</code> method
that returns the length of the returned iterators.</p>
<p>.. note:: The :meth:<code>__len__</code> method isn't strictly required by
          :class:<code>~torch.utils.data.DataLoader</code>, but is expected in any
          calculation involving the length of a :class:<code>~torch.utils.data.DataLoader</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ImageSequence" class="doc_header"><code>class</code> <code>ImageSequence</code><a href="https://github.com/mnpinto/banet/tree/master/banet/train.py#L70" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ImageSequence</code>(<strong><code>learn</code></strong>, <strong><code>sequence_len</code></strong>=<em><code>64</code></em>, <strong><code>n_sequences</code></strong>=<em><code>1</code></em>) :: <code>LearnerCallback</code></p>
</blockquote>
<p>Base class for creating callbacks for a <code>Learner</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_y_fn" class="doc_header"><code>get_y_fn</code><a href="https://github.com/mnpinto/banet/tree/master/banet/train.py#L83" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_y_fn</code>(<strong><code>file</code></strong>, <strong><code>satellite</code></strong>=<em><code>'VIIRS750'</code></em>, <strong><code>target_product</code></strong>=<em><code>'MCD64A1C6'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="open_mat" class="doc_header"><code>open_mat</code><a href="https://github.com/mnpinto/banet/tree/master/banet/train.py#L88" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>open_mat</code>(<strong><code>fn</code></strong>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="open_mask" class="doc_header"><code>open_mask</code><a href="fastai/vision/image.py#L404" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>open_mask</code>(<strong><code>fn</code></strong>:<code>Union</code>[<code>Path</code>, <code>str</code>], <strong><code>div</code></strong>=<em><code>False</code></em>, <strong><code>convert_mode</code></strong>=<em><code>'L'</code></em>, <strong><code>after_open</code></strong>:<code>Callable</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Return <code>ImageSegment</code> object create from mask in file <code>fn</code>. If <code>div</code>, divides pixel values by 255.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="set_info_df" class="doc_header"><code>set_info_df</code><a href="https://github.com/mnpinto/banet/tree/master/banet/train.py#L103" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>set_info_df</code>(<strong><code>items_list</code></strong>, <strong><code>satellite</code></strong>=<em><code>'VIIRS750'</code></em>, <strong><code>target_product</code></strong>=<em><code>'MCD64A1C6'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SegLabelListCustom" class="doc_header"><code>class</code> <code>SegLabelListCustom</code><a href="https://github.com/mnpinto/banet/tree/master/banet/train.py#L117" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SegLabelListCustom</code>(<strong><code>items</code></strong>:<code>Iterator</code>[<code>T_co</code>], <strong><code>classes</code></strong>:<code>Collection</code>[<code>T_co</code>]=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <code>SegmentationLabelList</code></p>
</blockquote>
<p><code>ItemList</code> for segmentation masks.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SegItemListCustom" class="doc_header"><code>class</code> <code>SegItemListCustom</code><a href="https://github.com/mnpinto/banet/tree/master/banet/train.py#L120" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SegItemListCustom</code>(<strong>*<code>args</code></strong>, <strong><code>convert_mode</code></strong>=<em><code>'RGB'</code></em>, <strong><code>after_open</code></strong>:<code>Callable</code>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <code>ImageList</code></p>
</blockquote>
<p><code>ItemList</code> suitable for computer vision.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BCE" class="doc_header"><code>class</code> <code>BCE</code><a href="https://github.com/mnpinto/banet/tree/master/banet/train.py#L156" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BCE</code>() :: <code>Module</code></p>
</blockquote>
<p>Binary Cross Entropy loss.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="accuracy" class="doc_header"><code>accuracy</code><a href="fastai/metrics.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>accuracy</code>(<strong><code>input</code></strong>:<code>Tensor</code>, <strong><code>targs</code></strong>:<code>Tensor</code>)</p>
</blockquote>
<p>Computes accuracy with <code>targs</code> when <code>input</code> is bs * n_classes.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="dice2d" class="doc_header"><code>dice2d</code><a href="https://github.com/mnpinto/banet/tree/master/banet/train.py#L168" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>dice2d</code>(<strong><code>pred</code></strong>, <strong><code>targs</code></strong>, <strong><code>thr</code></strong>=<em><code>0.5</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mean_absolute_error" class="doc_header"><code>mean_absolute_error</code><a href="fastai/metrics.py#L75" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mean_absolute_error</code>(<strong><code>pred</code></strong>:<code>Tensor</code>, <strong><code>targ</code></strong>:<code>Tensor</code>)</p>
</blockquote>
<p>Mean absolute error between <code>pred</code> and <code>targ</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train_model" class="doc_header"><code>train_model</code><a href="https://github.com/mnpinto/banet/tree/master/banet/train.py#L183" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train_model</code>(<strong><code>val_year</code></strong>, <strong><code>r_fold</code></strong>, <strong><code>path</code></strong>, <strong><code>model_path</code></strong>, <strong><code>n_epochs</code></strong>=<em><code>8</code></em>, <strong><code>lr</code></strong>=<em><code>0.01</code></em>, <strong><code>nburned</code></strong>=<em><code>10</code></em>, <strong><code>n_episodes_train</code></strong>=<em><code>2000</code></em>, <strong><code>n_episodes_valid</code></strong>=<em><code>100</code></em>, <strong><code>sequence_len</code></strong>=<em><code>64</code></em>, <strong><code>n_sequences</code></strong>=<em><code>1</code></em>, <strong><code>do_cutout</code></strong>=<em><code>True</code></em>, <strong><code>model_arch</code></strong>=<em><code>None</code></em>, <strong><code>pretrained_weights</code></strong>=<em><code>None</code></em>, <strong><code>satellite</code></strong>=<em><code>'VIIRS750'</code></em>, <strong><code>target_product</code></strong>=<em><code>'MCD64A1C6'</code></em>, <strong><code>get_learner</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

